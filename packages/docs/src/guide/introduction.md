# What is vue-vnode-utils?

`vue-vnode-utils` is a collection of functions that can be used to manipulate Vue VNodes. They are intended to be used inside [`render()`](https://vuejs.org/guide/extras/render-function.html) functions. The most common use case would be manipulating an array of child VNodes returned by a slot:

```vue
<script>
export default {
  render() {
    const children = this.$slots.default()

    // How can we change the VNodes in `children` here?
    // ...
  }
}
</script>
```

Working with the array of children is sometimes relatively straightforward, but it can become complicated if the slotted content is using directives such as `v-for` or `v-if`. In particular, a `v-for` will introduce a fragment VNode, which wraps around the VNodes that represent the components and elements generated by the `v-for`.

In general, manipulating VNodes is quite difficult, but `vue-vnode-utils` can help with some of the most common cases. The various helpers can be used to iterate over the 'top-level' child VNodes, including those wrapped in fragments. They can then be used to add or remove VNodes, or change the props of the existing VNodes.

---

An example of adding a CSS `class` to the children in a slot:

```js
import { h } from 'vue'
import { addProps } from '@skirtle/vue-vnode-utils'

export default {
  render() {
    const children = addProps(this.$slots.default(), () => {
      return {
        class: 'my-child'
      }
    })

    return h('div', children)
  }
}
```

See it on the SFC Playground: [Composition API](https://play.vuejs.org/#eNp1U02P0zAQ/SujcGgqNR8L4hL6wbJnECcuBKG0cVuziW3ZTjZV1P/Os5O03cJGOYyf572ZsZ/74FGpuG1YkAVLs9NcWTLMNmqdC14rqS31pNl+QTtZq8ayks6017KmGUizS9LTkVflE1KkYMKOGXHyGnZ1QMnFTgpjodggdeXkww/zCeWW1QboVC8M57Ra09fCHuO66MJ0McZchF4hbouqYQt6SOdzqCyTYQwMgAXEVFVYhhXRkgtIUhvVsmTVKg88Pw/InhTDUjT1lmmsoY1l6qKiQ/SAcFB4PZDHgJa8XX9he6nZMnHxFUYxwE6bOH432yjlvr4nQefzmH5HXT/uLdNXdHl3mgCXyWW+YBEMVxHVhYr/GClwo73j5eMGCmfkEYd9Ns9c24oluJOoFTiQqLG88kl5cLRWmSxJGqGeDzGuInkrH+0Zew/GzNTRVssXw3Rcshb95IGrjFHP6PRfW1ztd2u84//N1lNRlt+1VOay/1Z73m6s87SS7YumAt114k0e/l5AzFTSQmk+HY7GlhY0+G7ECH507nS5P75B3lnUEzGfl93EIGw29POXK3nL2blpNRNgTH2HV53FfaFLAzcIpKrCmIxm9Snyehhs2hr9gwD2n+JR4xjO4J8Znu/YBFJ8qnfBeCP3j8bYU+VeTDwVG1rZSl0yndGD6sjIipf0Lk3TT26rLvSBi8hKldFH1Y1YF73w0h4zep+mI6hwAlwcpqyhtC8XnP8CnQSDaQ==) | [Options API](https://play.vuejs.org/#eNp1U8uO2zAM/BXCLZAE8CstenGdpNs9t+ipl7oHJ1ZidW1JkOisg8D/Xkp+5LEbwwdxRM5Q1OjsPSkVHhvmJV5qdporXGeC10pqhOeSV8WzpEAwgbDXsoZZGN3CtniWiUyw1hUVbJ83FcI5EwC7McskPQB3pBbrfFsOUOSYzxdjnmbYaDFGlqoRmMDnPu6uC61Kg6yYNDiy2lyoJrIfOZZhnbfz2B/WXMyx5CZ07D4s48XiWiAT9KfRNBgKiFpVOTKKAFIuSBmOQS0LVq0yz/FkHuBJMQpFU2+ZppiEKIztKm9ptaRlz3A7D4cRWvDj+jvbS83SyK4vMIkRbLmB029POlDZ73wGAZ1rntLvStdPe2T6gqZ3V0lgGk3n83yv90FQ5yr8Z6Qgj7iJZsMGCU8jz7xv5oVrrFhEhgiOggYSNMgrl5R5JaIySRQ1Qr0caNx19Cif2jN4D4bM1MFWy1fDdFiwI/WTeeMVUadvPfmeoc9QQjf4uLfttJEXxS8tlZn2H7X30OuaiYLpi+t2UhgEU0n8/ZOqDazAWe2jhQwdwtVuQqrYbODP32GOV7U7eyiipcqxvfmFzweqXK3fmHyKiabKDb28WX0KHBf13m8MBunI7DevrZzPyBwzf5J2r+G9Z2DwVNk3EI7cve5WahpCAkvVgpEVL+BDHMdf7Vad6wMXAUqVwBfVDlgbvPICywQ+xfEAKjosF4cxq5d2cl73HxyMkFw=)

---

An example of inserting an `<hr>` between each of the children:

```js
import { h } from 'vue'
import { betweenChildren } from '@skirtle/vue-vnode-utils'

export default {
  render() {
    const children = betweenChildren(this.$slots.default(), () => h('hr'))

    return h('div', children)
  }
}
```

See it on the SFC Playground: [Composition API](https://play.vuejs.org/#eNp1U02PmzAQ/SsjeoBI4WNb9UJJ0u2e22MvpapImAR3wbZsQ1gh/nvHBjYN7SIOnueZN1/Pg/coZdS16KVepk+KSQMaTSv3OWeNFMrAAArPWziJRrYGSxjhrEQDPgX5r05PFavLJ3IRHLmZPaL4HrZ5KCTnJ8G1IcaWXHeWPviwWVBmsNGELvmCYAO7PXwtTBU1RR8k2/nMeOAYoq6oW9zCQ7LZEEsWT21QA2QQmawLg2QBZIwTJXRhI0qsd7nn4nMPzItEMnnbHFGRTdxkJvZU9HR6oOPEcN+QwwgtWbf/gmehMIvt+QZTMoItNzD6bW8zlf2GATiM4+y+Ct0/ng2qG5qtpklgFr/25229aRVhU8jotxacNjrYuHy+oMQpOMRin/UzU6bGmHYSdpwGEraG1c4p9ypjpE7juOXy+RLRKuK3/Kk8bdZghLoJj0pcNaqoxI7qyT2bmVodqdJ/ZXGT39/Cq/4vtgGOaK6I3PEopBnObm9V6VSHvYsu8Vy0NbHYgpzWg19b4tS1MBrGzTIjRVeKwyS/GQOSpRWp9f3+jeitUl0gteloDxEFHA7w4+d9xGkpdbcuPriRbedsVeBXyrdqXkjmYuiC5ODbck91oXUKviMO7Wtxw/RhpLc6U2+m4InEycwuYP1GtHmp7QOJVlRT00ehSlQpPMgetKhZCe+SJPlkr5pCXRgPjZApfJT9jPXhlZWmSuF9ksygLMqS8cviNVXgsnrjH3dnhfI=) | [Options API](https://play.vuejs.org/#eNp1U02PmzAQ/SsjWomsxFda9UJJ2u2e22MvpQcSnOAu2JY9JKyy+e8dm48k7AZx8DzPezMeP5+8R6WiQ8u81MvMVnOF61zwRkmN8FTxunySFAgmEHZaNuBH8S1syX4ucsE6RyrZrmhrhFMuALZjlkl7AGaiFjsHlg5QFlgsHsY8zbDVYoysVCswhc99fL4m2iotsnKqwZE15iI1if0ssIqaolskwbDmYoEVN5FTD2CZPDxcF8gF/Vk8DYYCklZ1gYwigIwLqgyHsJElq1e553RyD/BFMQpF22yYppgKUZjYVdHRaknLXuF2Hg4jtOSH9Q+2k5plsV1fYCpGsNUGTr896SBlv9MJBJxd85Q+o64fd8j0Bc1mV0lgFk/n8wKv90HYFCr6Z6Qgj7iJ5sMGFZ5GnnvfzTPXWLOYDBEeBA0kbJHXLin3KkRl0jhuhXre07ib+F4+tWdwDkbMNOFGy6NhOirZgfrJvfGKqNO3nnzP0Ceo4Dz4uLfttLFheGRMOB3NaIZD2r0u71qeyCXTF/NtpTAIppb4+xexDazAOe6jhQydxXG/RcR4fYU/f69Z27Gb1by/xUUwAKKu1lAt/Er71r83D4hgum8/oDNu68LQQ/SdbDi9TZ8e0lTK2f893xt8qa3poxm7P+dGajp1CkvVgZE1L+FDkiRf7VZT6D0XIUqVwhfVDVgXHnmJVQqfkmQAVVGWXOzHrL4DV9U7/we9MZOf)

---

There are more detailed examples, with demos, later in the guide. The key thing to appreciate is that these components will work even if the slotted content is using directives like `v-for` or `v-if`. The helper functions will walk the tree of fragments created by `v-for` and skip over the hidden comment nodes created by `v-if`, yielding the component and element nodes that would typically be regarded as the 'direct' children.

Is manipulating VNodes like this actually a good idea? Probably not. Most of the time it'd be better to solve the problem some other way. But if you find yourself in one of those rare edge cases where you really do need to tweak VNodes then it's probably better to use a library to smooth over some of the problems for you.

`vue-vnode-utils` doesn't replicate functionality that is already present in Vue itself. In particular, you should be familiar with [`isVNode()`](https://vuejs.org/api/render-function.html#isvnode) and [`cloneVNode()`](https://vuejs.org/api/render-function.html#clonevnode). That said, the helpers in `vue-vnode-utils` are designed in such a way that those core functions are often unnecessary.
